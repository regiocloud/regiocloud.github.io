<!doctype html>
<html lang="de" dir="ltr" class="docs-wrapper plugin-docs plugin-id-tutorials docs-version-current docs-doc-page docs-doc-id-hetzner-community/install-and-configure-prometheus-stack" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Installation und Konfiguration der Monitoring-Lösung Prometheus | REGIO – Die regionale Cloud aus Baden-Württemberg</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://regiocloud.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://regiocloud.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://regiocloud.github.io/tutorials/hetzner-community/install-and-configure-prometheus-stack"><meta data-rh="true" property="og:locale" content="de"><meta data-rh="true" name="docusaurus_locale" content="de"><meta data-rh="true" name="docsearch:language" content="de"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-tutorials-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-tutorials-current"><meta data-rh="true" property="og:title" content="Installation und Konfiguration der Monitoring-Lösung Prometheus | REGIO – Die regionale Cloud aus Baden-Württemberg"><meta data-rh="true" name="description" content="Dieses Tutorial wurde ursprünglich von Florian Bauer am 2021-08-11 in"><meta data-rh="true" property="og:description" content="Dieses Tutorial wurde ursprünglich von Florian Bauer am 2021-08-11 in"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://regiocloud.github.io/tutorials/hetzner-community/install-and-configure-prometheus-stack"><link data-rh="true" rel="alternate" href="https://regiocloud.github.io/tutorials/hetzner-community/install-and-configure-prometheus-stack" hreflang="de"><link data-rh="true" rel="alternate" href="https://regiocloud.github.io/tutorials/hetzner-community/install-and-configure-prometheus-stack" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="REGIO – Die regionale Cloud aus Baden-Württemberg RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="REGIO – Die regionale Cloud aus Baden-Württemberg Atom Feed"><link rel="stylesheet" href="/assets/css/styles.886c8a62.css">
<script src="/assets/js/runtime~main.e42c175d.js" defer="defer"></script>
<script src="/assets/js/main.4175f6e7.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Zum Hauptinhalt springen"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Zum Hauptinhalt springen</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="REGIO Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="REGIO Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/docs/">Dokumentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/tutorials">Tutorials</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://osism.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Open Cloud Infrastructure<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://scs.community" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Sovereign Cloud Stack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Umschalten zwischen dunkler und heller Ansicht (momentan heller Modus)" aria-label="Umschalten zwischen dunkler und heller Ansicht (momentan heller Modus)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Suche" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Zurück nach oben scrollen" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tutorials/">Übersicht</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tutorials/terraform">Terraform</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/tutorials/hetzner-community/">Hetzner Community</a><button aria-label="Collapse sidebar category &#x27;Hetzner Community&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/tutorials/hetzner-community/install-and-configure-prometheus-stack">Installation und Konfiguration der Monitoring-Lösung Prometheus</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/tutorials/hetzner-community/"><span itemprop="name">Hetzner Community</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Installation und Konfiguration der Monitoring-Lösung Prometheus</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">Auf dieser Seite</button></div><div class="theme-doc-markdown markdown"><header><h1>Installation und Konfiguration der Monitoring-Lösung Prometheus</h1></header><div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Dieses Tutorial wurde ursprünglich von <a href="https://github.com/fsrv-xyz" target="_blank" rel="noopener noreferrer">Florian Bauer</a> am 2021-08-11 in
<a href="https://github.com/hetzneronline/community-content/tree/master/tutorials/install-and-configure-prometheus-stack" target="_blank" rel="noopener noreferrer">hetzneronline/community-content</a> veröffentlicht. Die letzten Änderungen wurden am
2023-12-05 gemacht.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="einführung">Einführung<a href="#einführung" class="hash-link" aria-label="Direkter Link zur Einführung" title="Direkter Link zur Einführung">​</a></h2>
<p><a href="https://prometheus.io" target="_blank" rel="noopener noreferrer">Prometheus</a> ist eine Software, welche es erlaubt, die Metriken von vielen verschiedenen Quellen wie Webservern, Systemauslastung oder auch Netzwerkhardware abzurufen und zu speichern.</p>
<p>Dieses Tutorial beschreibt, wie die Performance-Daten eines Servers mit Prometheus abgefragt und mit <a href="https://grafana.com" target="_blank" rel="noopener noreferrer">Grafana</a> ausgewertet werden können.</p>
<p><strong>Voraussetzungen</strong></p>
<ul>
<li>2 Server mit Debian 11</li>
<li>Freigabe des TCP-Ports 9100 in der <a href="https://regiocloud.github.io/docs/netzwerk" target="_blank" rel="noopener noreferrer">Security Group</a> für den <strong>zu überwachenden Server</strong></li>
<li>Freigabe des TCP-Ports 3000 in der <a href="https://regiocloud.github.io/docs/netzwerk" target="_blank" rel="noopener noreferrer">Security Group</a> für den <strong>überwachenden Server</strong></li>
</ul>
<p><strong>Aufbau des Systems</strong></p>
<p>In den folgenden Schritten wird <strong>node1.example.com</strong> als Beispiel für den <strong>zu überwachenden Server</strong> verwendet und <strong>prometheus.example.com</strong> als Beispiel für den <strong>überwachenden Server</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="schritt-1---installation-von-node-exporter-auf-dem-zu-überwachenden-server">Schritt 1 - Installation von Node Exporter auf dem zu überwachenden Server<a href="#schritt-1---installation-von-node-exporter-auf-dem-zu-überwachenden-server" class="hash-link" aria-label="Direkter Link zur Schritt 1 - Installation von Node Exporter auf dem zu überwachenden Server" title="Direkter Link zur Schritt 1 - Installation von Node Exporter auf dem zu überwachenden Server">​</a></h2>
<p>Der Prometheus-Stack besteht aus mehreren Komponenten. Prometheus stellt hierbei den Speicher sowie das Sammeln der Metriken von diversen Endpunkten bereit. Diese Endpunkte können von jeder Software angeboten werden. Eine Liste der Exporter und integrierten Schnittstellen kann <a href="https://prometheus.io/docs/instrumenting/exporters/" target="_blank" rel="noopener noreferrer">hier</a> eingesehen werden.</p>
<p>Für dieses Tutorial wird die Software <a href="https://github.com/prometheus/node_exporter" target="_blank" rel="noopener noreferrer">Node Exporter</a> genutzt, welche Metriken über System-Ressourcen wie Prozessorauslastung, Netzwerknutzung oder Festplattenaktivität ausliest.</p>
<p>Auf dem zu überwachenden Server muss für die Installation folgendes ausgeführt werden:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apt update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apt install prometheus-node-exporter</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Die Metriken-Schnittstelle des Exporters sollte nun auf dem TCP-Port 9100 antworten. HTTP-Clients, wie beispielsweise curl, können somit Metriken anfragen.</p>
<p>Mit folgendem Befehl erhalten Sie aktuelle Werte über Systemd-Units.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@node1.example.com:~# curl -s http://127.0.0.1:9100/metrics | grep node_systemd_units</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># HELP node_systemd_units Summary of systemd unit states</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># TYPE node_systemd_units gauge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">node_systemd_units{state=&quot;activating&quot;} 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">node_systemd_units{state=&quot;active&quot;} 146</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">node_systemd_units{state=&quot;deactivating&quot;} 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">node_systemd_units{state=&quot;failed&quot;} 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">node_systemd_units{state=&quot;inactive&quot;} 70</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="schritt-2---installation-des-prometheus-servers-auf-dem-überwachenden-server">Schritt 2 - Installation des Prometheus Servers auf dem überwachenden Server<a href="#schritt-2---installation-des-prometheus-servers-auf-dem-überwachenden-server" class="hash-link" aria-label="Direkter Link zur Schritt 2 - Installation des Prometheus Servers auf dem überwachenden Server" title="Direkter Link zur Schritt 2 - Installation des Prometheus Servers auf dem überwachenden Server">​</a></h2>
<p>In diesem Beispiel wird der Prometheus Server dazu genutzt, die vom Node Exporter bereitgestellten Metriken in die integrierte Datenbank OpenTSDB abzulegen. Die Installation des Servers läuft wie folgt ab:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apt update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apt install prometheus jq</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Prometheus bezieht seine Konfiguration aus einer im Format Yaml abgelegten Datei. Darin sind unter anderem die Adresse der zu überwachenden Endpunkte sowie das Intervall angegeben, nach dem die Werte periodisch abgerufen werden. Bearbeiten Sie den <code>scrape_configs</code>-Abschnitt in der <code>/etc/prometheus/prometheus.yml</code>-Datei wie folgt:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">scrape_configs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">job_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;node_exporter at node1&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">static_configs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">targets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;node1.example.com:9100&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><code>job_name</code> der Name des Jobs</li>
<li><code>static_configs</code> beinhaltet die Konfiguration für Hosts mit statischer IP</li>
<li><code>targets</code> enthält eine oder mehrere <code>&lt;host&gt;:&lt;port&gt;</code>-Paare, zu denen eine Verbindung aufgebaut werden soll</li>
</ul>
<p>Abschließend muss der Prometheus-Service neu geladen werden.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl reload prometheus.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Mit <code>systemctl status prometheus</code> kann geprüft werden, ob das Neuladen des Services erfolgreich war.</p>
<p>Um den Status der zu überwachenden Server anzuzeigen, kann folgender Befehl ausgeführt werden:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@prometheus.example.com:~# curl --silent 127.0.0.1:9090/api/v1/targets | jq -r &#x27;.data.activeTargets[]|.scrapeUrl,.health,.lastError&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Im Output sollte Ihnen folgende Information angezeigt werden:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">http://node1.example.com:9100/metrics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">up</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="schritt-3---installation-von-grafana-auf-dem-überwachenden-server">Schritt 3 - Installation von Grafana auf dem überwachenden Server<a href="#schritt-3---installation-von-grafana-auf-dem-überwachenden-server" class="hash-link" aria-label="Direkter Link zur Schritt 3 - Installation von Grafana auf dem überwachenden Server" title="Direkter Link zur Schritt 3 - Installation von Grafana auf dem überwachenden Server">​</a></h2>
<p>Da die Metriken der zu überwachenden Knoten durchgehend vom Prometheus Server abgerufen und für 15 Tage gespeichert werden, können die Daten über mehrere Wege angezeigt/ausgewertet werden.
In diesem Tutorial benutzen wir Grafana, welches Dashboards für viele verschiedene Datenquellen über ein Webinterface bereitstellt.</p>
<p>Die Aktivierung des Grafana-Repositories sowie die nachfolgende Installation auf <strong>prometheus.example.com</strong> wird wie folgt durchgeführt:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apt install apt-transport-https software-properties-common wget</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wget -q -O - https://packages.grafana.com/gpg.key | apt-key add -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;deb https://apt.grafana.com stable main&quot; &gt; /etc/apt/sources.list.d/grafana.list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apt update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apt install grafana</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Aktivieren und starten Sie nun abschließend den Grafana-Daemon:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl enable grafana-server.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start grafana-server.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="schritt-4---konfiguration-des-grafana-servers">Schritt 4 - Konfiguration des Grafana-Servers<a href="#schritt-4---konfiguration-des-grafana-servers" class="hash-link" aria-label="Direkter Link zur Schritt 4 - Konfiguration des Grafana-Servers" title="Direkter Link zur Schritt 4 - Konfiguration des Grafana-Servers">​</a></h2>
<p>Der Grafana-Server stellt ein Webinterface bereit. Beachten Sie, dass die Sicherheitseinstellungen für Grafana noch nicht eingerichtet wurden. Solange die Verbindung zwischen Ihrem Browser und dem Dashboard-Server nicht sicher ist, verwenden Sie nur Zugangsdaten, die sich für Testzwecke eignen.</p>
<p>Auf das Webinterface kann über folgende URL zugegriffen werden:</p>
<div class="language-url codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-url codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">http://prometheus.example.com:3000/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="In die Zwischenablage kopieren" title="Kopieren" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Die Default-Zugangsdaten sind:</p>
<ul>
<li>Nutzername: <strong>admin</strong></li>
<li>Passwort: <strong>admin</strong></li>
</ul>
<p>Nachdem Sie sich das erste Mal eingeloggt haben, können Sie das Passwort ändern.</p>
<p>Zu diesem Zeitpunkt sind noch keine Datenquellen oder Dashboards eingerichtet. Fügen Sie als erstes eine Datenquelle hinzu.</p>
<p><img loading="lazy" alt="Grafana: &amp;quot;Configuration&amp;quot; menu with selected &amp;quot;Data sources&amp;quot; menuitem" src="/assets/images/grafana-configuration-menu-with-selected-data_sources-menuitem-2b3892728043fcb773f9e5f55c711d0a.png" width="800" height="800" class="img_ev3q"></p>
<p>Wählen Sie als &quot;Data source&quot; Typ <code>Prometheus</code> und geben Sie <code>http://localhost:9090</code> im URL-Feld an. Wählen Sie anschließend <code>Save &amp; test</code> aus, um die Datenquelle zu erstellen.</p>
<p>Um ein neues Dashboard zu erstellen, können Sie zwischen zwei Möglichkeiten wählen:</p>
<ul>
<li>Erstellung individueller Panels und Dashboards</li>
<li>Import bereits von der Community angelegter Vorlagen</li>
</ul>
<p>Um die gespeicherten Metriken des <code>node_exporters</code> anzuzeigen, kann dieses bereits <a href="https://grafana.com/grafana/dashboards/1860" target="_blank" rel="noopener noreferrer">vordefinierte Dashboard</a> verwendet werden.</p>
<p>Kopieren Sie die ID, um das Dashboard in Ihr Grafana zu importieren.</p>
<p><img loading="lazy" alt="Grafana: &amp;quot;Dashboards&amp;quot; menu with selected &amp;quot;+ Import&amp;quot; menuitem" src="/assets/images/grafana-dashboards-menu-with-selected-import-menuitem-52a9c5a1c3a6a5ffaa856b979644bfdf.png" width="800" height="800" class="img_ev3q"></p>
<p>Wählen Sie <strong>+ Import</strong> aus, fügen Sie die kopierte ID ein und klicken Sie auf <strong>Load</strong>.
Wählen Sie die Prometheus-Datenquelle für das Dashboard aus:</p>
<p><img loading="lazy" alt="Grafana: Import dashboard &amp;quot;Node Exporter Full&amp;quot;" src="/assets/images/grafana-import-dashboard-node_exporter_full-472ce765ace842eff047ad9bdbf2d651.png" width="800" height="800" class="img_ev3q"></p>
<p>Nun ist das Dashboard importiert und zeigt die bisher gespeicherten Daten des zu überwachenden Servers an.</p>
<p><img loading="lazy" alt="Grafana: &amp;quot;Node Exporter Full&amp;quot; dashboard with data" src="/assets/images/grafana-node_exporeter_full-dashboard-with-data-042ae56553fe74b28037457eaa5f6c1c.png" width="800" height="800" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ergebnis">Ergebnis<a href="#ergebnis" class="hash-link" aria-label="Direkter Link zur Ergebnis" title="Direkter Link zur Ergebnis">​</a></h2>
<p>In diesem Tutorial wurde ein Prometheus-Stack aufgesetzt, um die Performance-Daten eines Servers auszulesen, abzufragen und grafisch darzustellen. Mit diesem Setup besteht die Basis für die Überwachung zahlreicher Dienste und Knoten.</p>
<p>Wenn Sie die <code>prometheus.yml</code>-Datei bearbeiten, um unter dem <code>scrape_configs</code>-Bereich einen neuen Job hinzuzufügen, können Sie neben dem <code>static_configs</code>-Parameter, mit welchem die Informationen von einer bestimmten IP-Adresse abgefragt werden, auch eine weitere Option nutzen. Prometheus bietet zusätzlich auch eine Reihe an <a href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/#scrape_config" target="_blank" rel="noopener noreferrer">offiziellen Service-Discovery-Mechanismen</a>. Mit diesen ist es möglich, verfügbare Host dynamisch von Prometheus erkennen und automatisch als Targets hinzufügen zu lassen.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tutorials/tags/debian">Debian</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tutorials/tags/prometheus">Prometheus</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Dokumentation Seiten"><a class="pagination-nav__link pagination-nav__link--prev" href="/tutorials/hetzner-community/"><div class="pagination-nav__sublabel">Zurück</div><div class="pagination-nav__label">Hetzner Community</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#einführung" class="table-of-contents__link toc-highlight">Einführung</a></li><li><a href="#schritt-1---installation-von-node-exporter-auf-dem-zu-überwachenden-server" class="table-of-contents__link toc-highlight">Schritt 1 - Installation von Node Exporter auf dem zu überwachenden Server</a></li><li><a href="#schritt-2---installation-des-prometheus-servers-auf-dem-überwachenden-server" class="table-of-contents__link toc-highlight">Schritt 2 - Installation des Prometheus Servers auf dem überwachenden Server</a></li><li><a href="#schritt-3---installation-von-grafana-auf-dem-überwachenden-server" class="table-of-contents__link toc-highlight">Schritt 3 - Installation von Grafana auf dem überwachenden Server</a></li><li><a href="#schritt-4---konfiguration-des-grafana-servers" class="table-of-contents__link toc-highlight">Schritt 4 - Konfiguration des Grafana-Servers</a></li><li><a href="#ergebnis" class="table-of-contents__link toc-highlight">Ergebnis</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/impressum">Impressum</a></li><li class="footer__item"><a class="footer__link-item" href="/datenschutz">Datenschutz</a></li></ul></div><div class="col footer__col"><div class="footer__title">Support</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://status.regio.digital" target="_blank" rel="noopener noreferrer" class="footer__link-item">Status<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://apimon.services.regio.digital/public-dashboards/17cf094a47404398a5b8e35a4a3968d4?orgId=1&amp;refresh=5m" target="_blank" rel="noopener noreferrer" class="footer__link-item">Health Monitoring - Region A<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/regiocloud" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 OSISM GmbH. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>